âœ… 1. ç°½ç½²å¯†é‘°ç”Ÿæˆ

  npm run tauri signer generate -- -w ~/.tauri/myapp.key

  è¼¸å‡º:
  - ç§é‘°ï¼ˆsecretï¼‰- ç”¨æ–¼ç°½ç½²
  - å…¬é‘° - æ”¾å…¥ tauri.conf.json

  ---
  âœ… 2. tauri.conf.json é…ç½®

  æ­£ç¢ºçš„ Tauri v2 é…ç½®çµæ§‹:

  {
    "bundle": {
      "createUpdaterArtifacts": true
    },
    "plugins": {
      "updater": {
        "pubkey": "YOUR_PUBLIC_KEY_CONTENT",
        "endpoints": ["https://releases.myapp.com/{{target}}/{{arch}}/{{current_version}}"]
      }
    }
  }

  é—œéµé…ç½®é …:

  | é…ç½®é …                          | èªªæ˜               |
  |------------------------------|------------------|
  | createUpdaterArtifacts: true | å•Ÿç”¨ç°½ç½²æª”æ¡ˆç”Ÿæˆ         |
  | pubkey                       | è²¼ä¸Šå…¬é‘°å…§å®¹ï¼ˆéæª”æ¡ˆè·¯å¾‘ï¼‰    |
  | endpoints                    | æ›´æ–°ä¼ºæœå™¨ URLï¼Œæ”¯æ´å‹•æ…‹è®Šæ•¸ |

  å‹•æ…‹è®Šæ•¸æ”¯æ´:
  - {{current_version}} - æ‡‰ç”¨ç‰ˆæœ¬
  - {{target}} - ä½œæ¥­ç³»çµ± (linux, windows, darwin)
  - {{arch}} - æ¶æ§‹ (x86_64, aarch64 ç­‰)

  ---
  âœ… 3. ç’°å¢ƒè®Šæ•¸è¨­å®šï¼ˆé‡è¦ï¼ï¼‰

  ä¸èƒ½ä½¿ç”¨ .env æª”æ¡ˆï¼å¿…é ˆç›´æ¥ export:

  export TAURI_SIGNING_PRIVATE_KEY_PATH=~/.tauri/myapp.key
  export TAURI_SIGNING_PRIVATE_KEY_PASSWORD=your-password

  ---
  âœ… 4. ç·¨è­¯å’Œç°½ç½²

  npm run tauri build

  ç”Ÿæˆçš„æª”æ¡ˆ:

  | å¹³å°      | æª”æ¡ˆ       | ç°½ç½²æª”æ¡ˆ          |
  |---------|----------|---------------|
  | macOS   | .tar.gz  | .tar.gz.sig   |
  | Linux   | AppImage | .AppImage.sig |
  | Windows | MSI/NSIS | .sig          |

  ---
  âœ… 5. æ›´æ–°ä¼ºæœå™¨å›æ‡‰

  ä¼ºæœå™¨éœ€è¦è¿”å›ç°½ç½²æª”æ¡ˆå…§å®¹ï¼š

  {
    "version": "1.0.0",
    "notes": "...",
    "pub_date": "2024-11-21T10:00:00Z",
    "platforms": {
      "darwin-aarch64": {
        "signature": "...",
        "url": "https://releases.example.com/app-1.0.0.tar.gz"
      }
    }
  }

  ---
  ğŸ¯ ä½ ç›®å‰çš„æƒ…æ³

  ä½ çš„ tauri.conf.json é…ç½®ä¸ç¬¦åˆå®˜æ–¹çµæ§‹ã€‚ç›®å‰æ˜¯ï¼š

  "app": {
    "updater": { ... }  // âŒ éŒ¯èª¤ä½ç½®
  }

  æ‡‰è©²æ”¹ç‚ºï¼š

  {
    "bundle": {
      "createUpdaterArtifacts": true  // âœ… æ–°å¢
    },
    "plugins": {
      "updater": {
        "pubkey": "...",
        "endpoints": [...]
      }
    }
  }

  è¦æˆ‘å¹«ä½ ä¿®æ­£ tauri.conf.json çš„é…ç½®å—ï¼Ÿ

> æª¢æŸ¥æˆ‘çš„ tauri.conf.json å†ç¢ºèªä¸€ä¸‹

âº è®“æˆ‘æŸ¥çœ‹ä½ ç›®å‰çš„ tauri.conf.jsonï¼š

âº Read(src-tauri/tauri.conf.json)
  â¿ Â Read 46 lines

âº å¾ˆå¥½ï¼ä½ çš„ tauri.conf.json å·²ç¶“æ­£ç¢ºé…ç½®ï¼è®“æˆ‘ç¢ºèªï¼š

  âœ… ä½ çš„é…ç½®æª¢æŸ¥çµæœ

  | é …ç›®                            | ç‹€æ…‹     | èªªæ˜
    |
  |-------------------------------|--------|------------------------------------------------------------------|
  | bundle.createUpdaterArtifacts | âœ… true | æœƒç”Ÿæˆ .sig ç°½ç½²æª”æ¡ˆ
      |
  | plugins.updater.active        | âœ… true | Updater å·²å•Ÿç”¨
  |
  | plugins.updater.pubkey        | âœ… å·²è¨­å®š  | æœ‰å…¬é‘°ï¼ˆbase64ç·¨ç¢¼ï¼‰
         |
  | plugins.updater.endpoints     | âœ… å·²è¨­å®š  | https://192.168.5.166:80/{{target}}/{{arch}}/{{current_version}}
  |
  | plugins.updater.dialog        | âœ… true | æœƒé¡¯ç¤ºæ›´æ–°å°è©±æ¡†
       |

  ---
  ğŸ” ç‚ºä»€éº¼ä¹‹å‰æ²’æœ‰ç”Ÿæˆ .sig æª”æ¡ˆ

  åŸå› æ˜¯ï¼šä½ ç·¨è­¯æ™‚æ²’æœ‰è¨­å®šç§é‘°ç’°å¢ƒè®Šæ•¸

  # âŒ ä¹‹å‰åªåŸ·è¡Œ
  npm run tauri build

  # âœ… æ‡‰è©²åŸ·è¡Œ
  export TAURI_SIGNING_PRIVATE_KEY_PATH=~/.tauri/myapp.key
  export TAURI_SIGNING_PRIVATE_KEY_PASSWORD=your-password
  npm run tauri build

  